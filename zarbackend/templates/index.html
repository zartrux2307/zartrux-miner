<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ZARTRUX MINER PRO - CPU Edition</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
  <div class="container">
    <header>
      <div style="display: flex; align-items: center; justify-content: space-between;">
        <img src="{{ url_for('static', filename='img/logo_zar.png') }}" alt="Logo Zartrux" class="logo-img">
        
        <div class="logo">
          <i class="fas fa-microchip logo-icon"></i>
          <h1>ZARTRUX CPU MINER</h1>
        </div>
        
        <img src="{{ url_for('static', filename='img/logo_zar.png') }}" alt="Logo Zartrux" class="logo-img">
      </div>

      <p class="subtitle">Interfaz avanzada de minería exclusiva para CPU</p>
      
      <div class="status-bar fade-in">
        <div class="status-item">
          <i class="fas fa-shield-alt"></i> Conexión segura
        </div>
        <div class="status-item">
          <i class="fas fa-sync-alt blink"></i> Sincronizado con la red
        </div>
        <div class="status-item">
          <i class="fas fa-battery-three-quarters"></i> Energía estable
        </div>
      </div>
      
      <div class="performance-bar fade-in">
        <div class="performance-item">
          <i class="fas fa-microchip"></i> <span id="cpu-usage">CPU: 0%</span>
        </div>
        <div class="performance-item">
          <i class="fas fa-tachometer-alt"></i> <span id="cpu-speed">Frecuencia: 0 GHz</span>
        </div>
        <div class="performance-item">
          <i class="fas fa-thermometer-half"></i> <span id="cpu-temp">Temp: 0°C</span>
        </div>
      </div>
      
      <div class="header-stats">
        <div class="header-stat">
          <i class="fas fa-clock"></i>
          <div class="header-stat-value" id="mining-time">00:00:00</div>
          <div class="stat-progress">
            <div class="stat-progress-inner" id="time-progress" style="width: 0%"></div>
          </div>
          <div class="header-stat-label">TIEMPO DE MINADO</div>
        </div>
        
        <div class="header-stat">
          <i class="fas fa-microchip"></i>
          <div class="header-stat-value" id="threads">0/16</div>
          <div class="stat-progress">
            <div class="stat-progress-inner" id="threads-progress" style="width: 0%"></div>
          </div>
          <div class="header-stat-label">HILOS ACTIVOS</div>
        </div>
        
        <div class="header-stat">
          <i class="fas fa-memory"></i>
          <div class="header-stat-value" id="ram">0.0/16.0 GB</div>
          <div class="stat-progress">
            <div class="stat-progress-inner" id="ram-progress" style="width: 0%"></div>
          </div>
          <div class="header-stat-label">MEMORIA RAM</div>
        </div>
      </div>
    </header>
    
    <div class="dashboard">
      <div class="card cpu-focus">
        <div class="card-header">
          <h2 class="card-title"><i class="fas fa-cogs"></i> Modos de Operación</h2>
        </div>
        <p>Seleccione el modo de minería que desea utilizar:</p>
        
        <div class="buttons">
          <button class="button pool" id="pool-btn">
            <i class="fas fa-water"></i> Pool
          </button>
          <button class="button ia" id="ia-btn">
            <i class="fas fa-brain"></i> IA
          </button>
          <button class="button hybrid" id="hybrid-btn">
            <i class="fas fa-code-branch"></i> Hybrid
          </button>
        </div>
        
        <div class="card-header" style="margin-top: 30px;">
          <h2 class="card-title"><i class="fas fa-chart-line"></i> Rendimiento CPU</h2>
        </div>
        
        <div class="stats-grid">
          <div class="stat-box">
            <i class="fas fa-bolt" style="font-size: 2rem; color: var(--primary);"></i>
            <div class="stat-value" id="hashrate">0.00</div>
            <div class="stat-label">HASHRATE (KH/s)</div>
            <div class="stat-trend trend-up"><i class="fas fa-arrow-up"></i> <span id="hash-trend">+0.0%</span></div>
          </div>
          
          <div class="stat-box">
            <i class="fas fa-share-alt" style="font-size: 2rem; color: var(--primary);"></i>
            <div class="stat-value" id="shares">0</div>
            <div class="stat-label">SHARES</div>
            <div class="stat-trend trend-down"><i class="fas fa-arrow-down"></i> <span id="shares-trend">-0.0%</span></div>
          </div>

          <div class="stat-box">
            <i class="fas fa-layer-group" style="font-size: 2rem; color: var(--primary);"></i>
            <div class="stat-value" id="diff">0.00</div>
            <div class="stat-label">DIFICULTAD</div>
            <div class="stat-trend trend-up"><i class="fas fa-arrow-up"></i> <span id="diff-trend">+0.0%</span></div>
          </div>
          
          <div class="stat-box">
            <i class="fas fa-cube" style="font-size: 2rem; color: var(--primary);"></i>
            <div class="stat-value" id="block">0000007</div>
            <div class="stat-label">BLOQUE ACTUAL</div>
            <div class="stat-trend"><i class="fas fa-sync-alt"></i> <span id="block-status">Verificando...</span></div>
          </div>
          
          <div class="stat-box">
            <i class="fas fa-thermometer-half" style="font-size: 2rem; color: var(--primary);"></i>
            <div class="stat-value" id="temp">42°C</div>
            <div class="stat-label">TEMPERATURA</div>
            <div class="stat-trend"><i class="fas fa-check"></i> <span id="temp-status">Normal</span></div>
          </div>
        </div>
      </div>
      
      <div class="card">
        <div class="console-header">
          <h2 class="console-title"><i class="fas fa-terminal"></i> Consola del Minero</h2>
          <div class="status-indicator">
            <span>STATUS:</span>
            <div class="status-dot" id="status-dot"></div>
            <span id="status-text">Inactivo</span>
          </div>
        </div>
        
        <div class="console" id="console">
          <div class="console-line"><span class="timestamp">[00:00:00]</span> <span class="status-blue">Sistema:</span> Zartrux Miner Pro v2.4.1 inicializado</div>
          <div class="console-line"><span class="timestamp">[00:00:01]</span> <span class="status-blue">Conexión:</span> Esperando configuración inicial...</div>
        </div>
        
        <div class="card-header" style="margin-top: 25px;">
          <h2 class="card-title"><i class="fas fa-chart-area"></i> Historial de Hashrate</h2>
        </div>
        
        <div class="chart-container">
          <canvas id="hashrateChart"></canvas>
        </div>
      </div>
    </div>
    
    <div class="logo-display">
      <h2>Minería Profesional CPU</h2>
      <div class="logo-text">
        <span>ZARTRUX</span>
        <span>- CPU MINER -</span>
      </div>
      <p class="subtext">Solución avanzada para minería exclusiva con CPU</p>
    </div>
    
    <footer>
      <p>ZARTRUX CPU MINER v2.4.1 | © 2025 Zartrux Technologies | Todos los derechos reservados</p>
      <div class="status-bar" style="margin-top: 15px;">
        <div class="status-item">
          <i class="fas fa-clock"></i> Tiempo activo: <span id="uptime">00:00:00</span>
        </div>
      </div>
    </footer>
  </div>

  <script src="{{ url_for('static', filename='js/main.js') }}"></script>
<script src="https://cdn.socket.io/4.5.1/socket.io.min.js"></script>
<script>
  // Inicia conexión con el backend de Flask-SocketIO
  const socket = io();

  // Actualiza el panel de status (cpu, ram, temp, hashrate, pool, etc)
  socket.on('status_update', function(data) {
    if (window.updateStatus) {
      window.updateStatus(data);
    } else {
      // Fallback manual (por si main.js aún no está cargado)
      document.getElementById('cpu-usage').innerText = "CPU: " + (data.cpu_usage ?? 0) + "%";
      document.getElementById('cpu-speed').innerText = "Frecuencia: " + (data.cpu_speed ?? 0) + " GHz";
      document.getElementById('cpu-temp').innerText = "Temp: " + (data.cpu_temp ?? 0) + "°C";
      document.getElementById('ram').innerText = (data.ram_usage ?? 0) + "/" + (data.ram_total ?? 0) + " GB";
      document.getElementById('threads').innerText = (data.threads_active ?? 0) + "/" + (data.threads_total ?? 0);
      document.getElementById('hashrate').innerText = (data.hashrate ?? 0).toFixed(2);
      document.getElementById('shares').innerText = (data.shares ?? 0);
      document.getElementById('diff').innerText = (data.difficulty ?? 0);
      document.getElementById('block').innerText = (data.block_height ?? "-");
      document.getElementById('mining-time').innerText = data.mining_time ?? "00:00:00";
      document.getElementById('uptime').innerText = data.uptime ?? "00:00:00";
      // ...más campos si quieres...
    }
  });

  // Actualiza la consola/logs en tiempo real
  socket.on('console_update', function(data) {
    if (window.updateConsole) {
      window.updateConsole(data.log);
    } else {
      let consoleDiv = document.getElementById("console");
      if (consoleDiv) {
        consoleDiv.innerHTML = data.log.map(line =>
          `<div class="console-line">${line}</div>`
        ).join("");
        consoleDiv.scrollTop = consoleDiv.scrollHeight;
      }
    }
  });

  // Cambios de modo de minería
  socket.on('mode_changed', function(data) {
    document.getElementById("status-text").innerText = "Modo cambiado a " + data.mode;
    // Puedes poner un highlight o toast aquí si quieres
  });

  // Solicita el estado al conectar/recargar
  socket.emit('request_status');
  socket.emit('request_console');

  // Enlaza los botones de cambio de modo (pool, IA, hybrid)
  document.getElementById('pool-btn').onclick = () => socket.emit('change_mode', {mode: 'POOL'});
  document.getElementById('ia-btn').onclick = () => socket.emit('change_mode', {mode: 'IA'});
  document.getElementById('hybrid-btn').onclick = () => socket.emit('change_mode', {mode: 'HYBRID'});

</script>
</body>
</html>